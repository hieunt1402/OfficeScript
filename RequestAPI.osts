{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook) {\n    let apiUrl = \"https://api.open-meteo.com/v1/forecast?latitude=21.0245&longitude=105.8412&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=Asia%2FBangkok&forecast_days=1\"; // Replace with your API endpoint URL.\n    let dataSheet = workbook.getWorksheet('Sheet1');\n    makeGetRequest(apiUrl, function (error, response) {\n        if (error) {\n            console.log(\"Request failed:\", error);\n        } else {\n            console.log(\"Response:\", response);\n            // Process the response data here\n            let weather_code: string = response['daily']['weather_code'][0];\n            let maxTemp: string = response['daily']['temperature_2m_max'][0];\n            let minTemp: string = response['daily']['temperature_2m_min'][0];\n            let description = getDetailsByKey(dataSheet, weather_code).description;\n            let image = getDetailsByKey(dataSheet, weather_code).image;\n\n            return {\n                description: description,\n                image: image,\n                maxTemp: maxTemp,\n                minTemp: minTemp\n            };\n        }\n    });\n}\nfunction makeGetRequest(url : string, callback : Function) {\n    let xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", url);\n\n    xhr.onload = function () {\n        if (xhr.status === 200) {\n            let response : JSON = JSON.parse(xhr.responseText);\n            callback(null, response);\n        } else {\n            callback(new Error(\"Request failed with status: \" + xhr.status), null);\n        }\n    };\n\n    xhr.onerror = function () {\n        callback(new Error(\"Request failed\"), null);\n    };\n\n    xhr.send();\n}\nfunction getDetailsByKey(worksheet: ExcelScript.Worksheet, key: string) {\n\n    let dataRange = worksheet.getUsedRange();\n\n    let keys = dataRange.getColumn(0).getValues();\n    let descriptions = dataRange.getColumn(1).getValues();\n    let images = dataRange.getColumn(2).getValues();\n\n    for (let i = 0; i < keys.length; i++) {\n        //console.log(keys[i][0] + '-' + key)\n        if (keys[i][0] == key) {\n            let description = descriptions[i][0];\n            let image = images[i][0];\n\n            return {\n                description: description,\n                image: image\n            };\n        }\n    }\n\n    return null; // Return null if the key is not found\n}","description":"","copilotMetadata":null,"parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}